Sub StockAnalyst()'letting the equation know to collect the first opening priceDim Start As BooleanStart = True'variable for the last row numberDim LastRow As Long'variable to save the opening priceDim OpenPrice As Double'variable to save the closing priceDim ClosePrice As Double'variable for the yearly changeDim YearlyChange As Double'variable for the percent changeDim PercentChange As Double'variable to save the volume of the stockDim StockVolume As Double'variable to count the line that the ticker info should be printed onDim TickerLine As IntegerTickerLine = 2'variable to track the number of worksheets to loop throughDim SheetCount As IntegerSheetCount = ActiveWorkbook.Worksheets.Count'loop to go through all the worksheetsFor j = 1 To SheetCount    ThisWorkbook.Worksheets(j).Activate        'Label the columns    Range("I1").Value = "Ticker"    Range("J1").Value = "Yearly Change"    Range("K1").Value = "Percent Change"    Range("L1").Value = "Total Stock Volume"        'finds the number of rows it needs to loop for on each sheet    LastRow = Cells(Rows.Count, 1).End(xlUp).Row    'Loop to go through the data    For i = 2 To LastRow            'Conditional to collect the first opening price        If Start = True Then                'Collect the first opening price            OpenPrice = Cells(2, 3).Value                    'Check to see if its collecting the right opening price            'Cells(TickerLine, 8).Value = OpenPrice            End If            'If the tickers are different        If Cells(i, 1).Value <> Cells(i + 1, 1).Value Then                   'Print the ticker symbol onto the info section            Cells(TickerLine, 9).Value = Cells(i, 1).Value                    'Add the last column count and then print            StockVolume = StockVolume + Cells(i, 7).Value                    'Print the stock volume            Cells(TickerLine, 12).Value = StockVolume                        'Save the closing price            ClosePrice = Cells(i, 6).Value                    'Check to see if its collecting the right closing price            'Cells(TickerLine, 11).Value = ClosePrice                    'Yearly change calculation            YearlyChange = ClosePrice - OpenPrice                        'Print the yearly change            Cells(TickerLine, 10).Value = YearlyChange                        'Conditional to check through for 0 values            If OpenPrice = 0 Then                PercentChange = 0                        ElseIf YearlyChange <> 0 Then                'Calculate the percent change Yearly Change/Open Price * 100                PercentChange = Round((YearlyChange / OpenPrice) * 100, 2)                        End If                            'Print the percent change                Cells(TickerLine, 11).Value = CStr(PercentChange) + "%"                        'Conditional to format the color of the cell green if it was positive            If YearlyChange > 0 Then                Cells(TickerLine, 10).Interior.ColorIndex = 4                    End If                    'Conditional to format the color of the cell red if it was negative            If YearlyChange < 0 Then                Cells(TickerLine, 10).Interior.ColorIndex = 3                    End If                    'Collect the next opening price            OpenPrice = Cells(i + 1, 3).Value                    'Check to see if its collecting the right opening price            'Cells(TickerLine + 1, 8).Value = OpenPrice                    'Add a line TickerLine            TickerLine = TickerLine + 1                    'Reset the stock volume            StockVolume = 0                    'Reset the yearly change            YearlyChange = 0                    'Letting the loop know its not at the beginning anymore            Start = False        'if the tickers are the same        ElseIf Cells(i, 1).Value = Cells(i, 1).Value Then                    'Add the stock volume            StockVolume = StockVolume + Cells(i, 7).Value                        End If            Next i                'Resetting the ticker line for the next sheet        TickerLine = 2                'Letting the code know its at the start of another sheet        Start = True        Next jEnd Sub